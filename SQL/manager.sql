DROP INDEX IDX_IPV4_STAR ON IPV4_ILINES;
DROP INDEX IDX_IPV4_STOP ON IPV4_ILINES;
DROP INDEX IDX_IPV6_STAR ON IPV6_ILINES;
DROP INDEX IDX_IPV6_STOP ON IPV6_ILINES;

TRUNCATE IPV4_ILINES;
TRUNCATE IPV6_ILINES;
LOAD DATA LOCAL INFILE '/home/iline/import/IPV4_FILE.db' INTO TABLE IPV4_ILINES COLUMNS TERMINATED BY '|';
LOAD DATA LOCAL INFILE '/home/iline/import/IPV6_FILE.db' INTO TABLE IPV6_ILINES COLUMNS TERMINATED BY '|';
DELETE n1 FROM IPV6_ILINES n1, IPV6_ILINES n2 WHERE n1.IPV6_ID > n2.IPV6_ID AND n1.IPV6_SERVER_NAME = n2.IPV6_SERVER_NAME AND n1.IPV6_NETWORK_START = n2.IPV6_NETWORK_START AND n1.IPV6_NETWORK_STOP = n2.IPV6_NETWORK_STOP;
DELETE n1 FROM IPV4_ILINES n1, IPV4_ILINES n2 WHERE n1.IPV4_ID > n2.IPV4_ID AND n1.IPV4_SERVER_NAME = n2.IPV4_SERVER_NAME AND n1.IPV4_NETWORK_START = n2.IPV4_NETWORK_START AND n1.IPV4_NETWORK_STOP = n2.IPV4_NETWORK_STOP;
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='irc.nebula.fi' and IPV4_MASK='0.0.0.0/0';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='atw.irc.hu' and IPV4_MASK='0.0.0.0/0';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='irc.home.uit.no' and IPV4_MASK='0.0.0.0/1';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='ssl.atw.irc.hu' and IPV4_MASK='0.0.0.0/0';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='irc.nfx.cz' and IPV4_MASK='0.0.0.0/0';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='irc.nfx.cz' and IPV4_MASK='128.0.0.0/1';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='irc.arnes.si' and IPV6_MASK='::/0';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='irc.nebula.fi' and IPV6_MASK='2a00::/8';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='irc.nfx.cz' and IPV4_MASK='0.0.0.0/1';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='irc.nebula.fi' and IPV6_MASK='2001::/16';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='ircd.seed.net.tw' and IPV6_MASK='::/1';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='irc.home.uit.no' and IPV6_MASK='::/1';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='irc.nebula.fi' and IPV6_MASK='2001::/16';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='irc.nfx.cz' and IPV4_MASK='128.0.0.0/1';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='eu.irc6.net' and IPV4_MASK='0.0.0.0/0';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='ircd.seed.net.tw' and IPV4_MASK='0.0.0.0/1';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='ircd.seed.net.tw' and IPV6_MASK='::/1';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='ircd.seed.net.tw' and IPV6_MASK='::/0';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='irc.powertech.no' and IPV6_MASK='::/1';
DELETE FROM IPV4_ILINES WHERE IPV4_SERVER_NAME='irc.powertech.no' and IPV4_MASK='0.0.0.0/1';
DELETE FROM IPV6_ILINES WHERE IPV6_SERVER_NAME='irc.nlnog.net';
UPDATE IPV4_ILINES SET IPV4_SERVER_NAME='irc.belwue.de' WHERE IPV4_SERVER_NAME='belwue.de';
UPDATE IPV4_ILINES SET IPV4_SERVER_NAME='irc.fu-berlin.de' WHERE IPV4_SERVER_NAME='fu-berlin.de';
UPDATE IPV4_ILINES SET IPV4_SERVER_NAME='irc.man-da.de' WHERE IPV4_SERVER_NAME='MAN-DA.DE';
UPDATE IPV4_ILINES SET IPV4_SERVER_NAME='irc.in.tum.de' WHERE IPV4_SERVER_NAME='TUM.DE';
UPDATE IPV4_ILINES SET IPV4_SERVER_NAME='irc.uni-erlangen.de' WHERE IPV4_SERVER_NAME='uni-erlangen.de';
UPDATE IPV6_ILINES SET IPV6_SERVER_NAME='irc.uni-erlangen.de' WHERE IPV6_SERVER_NAME='uni-erlangen.de';
UPDATE IPV6_ILINES SET IPV6_SERVER_NAME='irc.belwue.de' WHERE IPV6_SERVER_NAME='belwue.de';
UPDATE IPV6_ILINES SET IPV6_SERVER_NAME='irc.man-da.de' WHERE IPV6_SERVER_NAME='MAN-DA.DE';
COMMIT;

CREATE INDEX IDX_IPV4_STAR ON IPV4_ILINES (IPV4_NETWORK_START);
CREATE INDEX IDX_IPV4_STOP ON IPV4_ILINES (IPV4_NETWORK_STOP);
CREATE INDEX IDX_IPV6_STAR ON IPV6_ILINES (IPV6_NETWORK_START);
CREATE INDEX IDX_IPV6_STOP ON IPV6_ILINES (IPV6_NETWORK_STOP);

OPTIMIZE TABLE IPV4_ILINES;
OPTIMIZE TABLE IPV6_ILINES;

